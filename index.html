<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>3D Lights Out</title>
<link href="https://fonts.googleapis.com/css?family=Roboto:400,500&display=swap" rel="stylesheet">
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Roboto', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
    color: #eef2f3;
  }
  h1 {
    font-weight: 500;
    letter-spacing: 1px;
  }
  #wrapper {
    perspective: 1000px;
    margin-top: 20px;
    background: rgba(255,255,255,0.05);
    border-radius: 20px;
    padding: 20px;
    backdrop-filter: blur(8px);
    box-shadow: 0 8px 32px rgba(0,0,0,0.5);
  }
  #game {
    display: grid;
    grid-template-columns: repeat(5, 80px);
    gap: 12px;
  }
  .cell {
    width: 80px;
    height: 80px;
    position: relative;
    transform-style: preserve-3d;
    transform-origin: center;
    transition: transform 0.4s, box-shadow 0.3s;
    cursor: pointer;
  }
  .cell:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
  }
  .cell.off {
    transform: rotateX(180deg);
  }
  .cell.off:hover {
    transform: rotateX(180deg) scale(1.05);
    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
  }
  .face {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 12px;
    backface-visibility: hidden;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.4);
    transform-style: preserve-3d;
  }
  .front {
    background: linear-gradient(145deg, #ffd500, #ffb700);
    transform: translateZ(20px);
  }
  .back {
    background: linear-gradient(145deg, #555, #333);
    transform: rotateX(180deg) translateZ(20px);
  }
  #controls {
    margin-top: 20px;
    display: flex;
    align-items: center;
    background: rgba(255,255,255,0.05);
    padding: 12px 20px;
    border-radius: 12px;
    backdrop-filter: blur(6px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.4);
  }
  button {
    background: linear-gradient(135deg, #ff7e5f, #feb47b);
    border: none;
    border-radius: 8px;
    padding: 10px 20px;
    font-size: 16px;
    font-weight: 500;
    color: #fff;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.3);
  }
  #moves {
    margin-left: 15px;
    font-size: 16px;
    font-weight: 500;
  }
</style>
</head>
<body>
<h1>3D Lights Out</h1>
<div id="wrapper">
  <div id="game"></div>
</div>
<div id="controls">
  <button id="reset">Reset</button>
  <span id="moves">Moves: 0</span>
</div>
<script>
const size = 5,
      game = document.getElementById('game'),
      movesDisplay = document.getElementById('moves'),
      resetBtn = document.getElementById('reset');
let cells = [], moves = 0;

function init() {
  moves = 0; updateMoves();
  game.innerHTML = ''; cells = [];
  for (let i = 0; i < size; i++) {
    const row = [];
    for (let j = 0; j < size; j++) {
      const cell = document.createElement('div');
      cell.className = 'cell';
      cell.dataset.i = i;
      cell.dataset.j = j;
      cell.innerHTML = '<div class="face front"></div><div class="face back"></div>';
      cell.addEventListener('click', onClick);
      game.appendChild(cell);
      row.push(cell);
    }
    cells.push(row);
  }
  scramble();
}

function toggle(i, j) {
  if (i < 0 || j < 0 || i >= size || j >= size) return;
  cells[i][j].classList.toggle('off');
}

function onClickCell(i, j) {
  toggle(i, j);
  toggle(i-1, j);
  toggle(i+1, j);
  toggle(i, j-1);
  toggle(i, j+1);
}

function onClick() {
  const i = +this.dataset.i,
        j = +this.dataset.j;
  onClickCell(i, j);
  moves++; updateMoves(); checkWin();
}

function updateMoves() {
  movesDisplay.textContent = 'Moves: ' + moves;
}

function checkWin() {
  for (let i = 0; i < size; i++)
    for (let j = 0; j < size; j++)
      if (!cells[i][j].classList.contains('off')) return;
  setTimeout(() => alert('You won in ' + moves + ' moves!'), 200);
}

function scramble() {
  for (let k = 0; k < size * size * 3; k++)
    onClickCell(
      Math.floor(Math.random() * size),
      Math.floor(Math.random() * size)
    );
  moves = 0; updateMoves();
}

resetBtn.addEventListener('click', init);
init();
</script>
</body>
</html>

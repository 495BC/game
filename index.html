<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>3D Lights Out</title>
<style>
body { margin:0; padding:0; display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; background:#1a1a1a; color:#fff; font-family:sans-serif; }
h1 { margin:20px; }
#game-container { perspective: 800px; }
#game { display:grid; grid-template-columns: repeat(5, 60px); grid-gap:5px; transform: rotateX(60deg) rotateZ(45deg); transform-style: preserve-3d; }
.cell { width:60px; height:60px; background: #222; cursor:pointer; position: relative; transition: background 0.3s, transform 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.5); }
.cell::before { content:''; position:absolute; top:0; left:0; width:100%; height:100%; background: #ffcc00; transform-origin: bottom; transform: rotateX(90deg) translateZ(-30px); transition: background 0.3s; }
.cell.off::before { background: #555; }
.cell:active { transform: translateY(4px); box-shadow: 0 2px 3px rgba(0,0,0,0.5); }
#controls { margin-top:20px; display:flex; align-items:center; }
button { padding:10px 20px; font-size:16px; margin-right:10px; }
#moves { font-size:16px; }
</style>
</head>
<body>
<h1>3D Lights Out</h1>
<div id="game-container">
  <div id="game"></div>
</div>
<div id="controls">
  <button id="reset">Reset</button>
  <span id="moves">Moves: 0</span>
</div>
<script>
let size = 5;
const game = document.getElementById('game');
const movesDisplay = document.getElementById('moves');
const resetBtn = document.getElementById('reset');
let moves = 0;
const cells = [];

function init() {
    moves = 0;
    updateMoves();
    game.innerHTML = '';
    for (let i = 0; i < size; i++) {
        cells[i] = [];
        for (let j = 0; j < size; j++) {
            const cell = document.createElement('div');
            cell.className = 'cell';
            cell.dataset.i = i;
            cell.dataset.j = j;
            cell.addEventListener('click', onClick);
            game.appendChild(cell);
            cells[i][j] = cell;
        }
    }
    scramble();
}

function updateMoves() {
    movesDisplay.textContent = 'Moves: ' + moves;
}

function toggle(i, j) {
    if (i < 0 || j < 0 || i >= size || j >= size) return;
    cells[i][j].classList.toggle('off');
}

function onClick(e) {
    const i = +e.currentTarget.dataset.i;
    const j = +e.currentTarget.dataset.j;
    toggle(i, j);
    toggle(i-1, j);
    toggle(i+1, j);
    toggle(i, j-1);
    toggle(i, j+1);
    moves++;
    updateMoves();
    checkWin();
}

function scramble() {
    for (let k = 0; k < size*size*3; k++) {
        const i = Math.floor(Math.random() * size);
        const j = Math.floor(Math.random() * size);
        toggle(i, j);
        toggle(i-1, j);
        toggle(i+1, j);
        toggle(i, j-1);
        toggle(i, j+1);
    }
}

function checkWin() {
    if (cells.flat().every(c => c.classList.contains('off'))) {
        setTimeout(() => alert('You won in ' + moves + ' moves!'), 100);
    }
}

resetBtn.addEventListener('click', init);
init();
</script>
</body>
</html>
